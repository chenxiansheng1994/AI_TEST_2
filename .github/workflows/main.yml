- name: Generate minimal Android app module if missing
      - name: Generate minimal Android app module if missing
        shell: bash
        run: |
          if [ ! -d "app" ]; then
            echo "Creating minimal Android app module..."

            mkdir -p app/src/main/java/com/cleanvideo/app
            mkdir -p app/src/main/res/values

            printf '%s\n' \
              'rootProject.name = "CleanVideo"' \
              'include(":app")' > settings.gradle.kts

            printf '%s\n' \
              'plugins { }' > build.gradle.kts

            printf '%s\n' \
              'org.gradle.jvmargs=-Xmx2g -Dfile.encoding=UTF-8' \
              'android.useAndroidX=true' \
              'android.enableJetifier=true' > gradle.properties

            printf '%s\n' \
              'plugins {' \
              '  id("com.android.application")' \
              '  id("org.jetbrains.kotlin.android")' \
              '}' \
              '' \
              'android {' \
              '  namespace = "com.cleanvideo.app"' \
              '  compileSdk = 34' \
              '' \
              '  defaultConfig {' \
              '    applicationId = "com.cleanvideo.app"' \
              '    minSdk = 24' \
              '    targetSdk = 34' \
              '    versionCode = 1' \
              '    versionName = "1.0"' \
              '  }' \
              '' \
              '  compileOptions {' \
              '    sourceCompatibility = JavaVersion.VERSION_17' \
              '    targetCompatibility = JavaVersion.VERSION_17' \
              '  }' \
              '  kotlinOptions { jvmTarget = "17" }' \
              '}' \
              '' \
              'dependencies {' \
              '  implementation("androidx.core:core-ktx:1.13.1")' \
              '  implementation("androidx.appcompat:appcompat:1.7.0")' \
              '  implementation("com.google.android.material:material:1.12.0")' \
              '}' \
              > app/build.gradle.kts

            printf '%s\n' \
              '<manifest xmlns:android="http://schemas.android.com/apk/res/android">' \
              '  <application android:label="CleanVideo" android:theme="@style/Theme.AppCompat.Light.NoActionBar">' \
              '    <activity android:name="com.cleanvideo.app.MainActivity" android:exported="true">' \
              '      <intent-filter>' \
              '        <action android:name="android.intent.action.MAIN" />' \
              '        <category android:name="android.intent.category.LAUNCHER" />' \
              '      </intent-filter>' \
              '    </activity>' \
              '  </application>' \
              '</manifest>' \
              > app/src/main/AndroidManifest.xml

            printf '%s\n' \
              'package com.cleanvideo.app' \
              '' \
              'import android.os.Bundle' \
              'import androidx.appcompat.app.AppCompatActivity' \
              '' \
              'class MainActivity : AppCompatActivity() {' \
              '  override fun onCreate(savedInstanceState: Bundle?) {' \
              '    super.onCreate(savedInstanceState)' \
              '  }' \
              '}' \
              > app/src/main/java/com/cleanvideo/app/MainActivity.kt
          fi
